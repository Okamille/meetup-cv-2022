from pathlib import Path

import matplotlib.pyplot as plt
import numpy as np
from joblib import load
from skimage.transform import resize
from sklearn import datasets


def rgb2gray(rgb):
    return 1 - np.dot(rgb[..., :3], [0.2989, 0.5870, 0.1140])


data_uri = "data:image/png;base64,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"
image = plt.imread(data_uri)
image_rescaled = resize(image, (28, 28), mode="constant", anti_aliasing=False)
image_rescaled = rgb2gray(image_rescaled)
image_rescaled = (image_rescaled * 255).astype(int)

model = load(Path(__file__).parent.parent / "model" / "mnist_model.joblib")
digits = datasets.load_digits()
print("Digits")
print(digits.images)
print(image_rescaled)

result = model.predict(image_rescaled.reshape(1, -1))

plt.imshow(image_rescaled)
plt.title(f"Prediction: {result[0]}")
plt.show()
